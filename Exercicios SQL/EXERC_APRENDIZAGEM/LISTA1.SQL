#BDEX1
USE BDEX1_HOSPITAL;
#EXERCICIO 1 - QUAIS SÃO OS NOMES E DATAS DE NASCIMENTO DE TODOS OS PACIENTES CADASTRADOS?
SELECT NOME, DATA_NASC 
FROM PACIENTES;

#EXERCICIO 2 - QUAL É O NÚMERO TOTAL DE MÉDICOS CADASTRADOS?
SELECT COUNT(*) AS QTD_MEDICOS #O USO DO CONECTIVO 'AS' É OPCIONAL
FROM MEDICOS;

#EXERCICIO 3 - QUAL É A IDADE MÉDIA DOS PACIENTES CADASTRADOS?
SELECT ROUND(AVG(TIMESTAMPDIFF(YEAR,DATA_NASC,CURDATE())),0) AS MEDIA_IDADE
FROM PACIENTES;

#BDEX2
USE BDEX2_PASSAGENS_AEREAS;
#EXERCICIO 1 - QUAIS SÃO OS NOMES E CIDADES DE TODOS OS AEROPORTOS CADASTRADOS?
SELECT NOME, CIDADE 
FROM AEROPORTOS;

#EXERCICIO 2 - QUANTOS VOOS ESTÃO CADASTRADOS PARA CADA COMPANHIA AÉREA?
SELECT CIA_AEREA, COUNT(*) 
FROM VOOS
GROUP BY CIA_AEREA;
#OU
SELECT CA.NOME_FANTASIA, COUNT(*) QTD_VOOS #QTD_VOOS É O ALIAS DE COUNT(*) SEM USAR 'AS'
FROM VOOS V
JOIN CIA_AEREAS CA ON CA.ID_CIA = V.CIA_AEREA
GROUP BY CA.NOME_FANTASIA;

#EXERCICIO 3 - QUAL É A CAPACIDADE MÉDIA DAS AERONAVES CADASTRADAS?
SELECT ROUND(AVG(POLTRONAS),1) MEDIA_VAGAS 
FROM AERONAVES;

#BDEX3
USE BDEX3_REDESOCIAL;
#1 - QUAIS SÃO OS NOMES E SOBRENOMES DE TODOS OS USUÁRIOS CADASTRADOS?
SELECT NOME_USUARIO,SOBRENOME 
FROM USUARIOS;

#2 - QUANTOS GRUPOS EXISTEM NA REDE SOCIAL?
SELECT COUNT(*) 
FROM GRUPOS;

#3 - QUAL É O NÚMERO MÉDIO DE COMENTÁRIOS POR POSTAGEM?
#CRIANDO UMA TABELA 'VIRTUAL' CONTA_POST E REALIZANDO A MEDIA DA CONSULTA ANTERIOR
SELECT ROUND(AVG(COMENTARIOS_POR_POSTAGEM),1) AS MEDIA
FROM (
	#RECUPERANDO A CONTAGEM DE POSTAGENS POR COMENTÁRIO
    SELECT COUNT(*) AS COMENTARIOS_POR_POSTAGEM
    FROM COMENTARIOS
    GROUP BY POST
) AS CONTA_POST ; #NOME DA MINHA BASE CONSULTADA

#BDEX4
USE BDEX4_ESTOQUE;
#1 - QUAIS SÃO OS NOMES E PREÇOS DE TODOS OS PRODUTOS CADASTRADOS?
SELECT NOME, PRECO AS VALOR 
FROM PRODUTOS;

#2 - QUANTOS PRODUTOS DIFERENTES CADA FORNECEDOR FORNECE?
SELECT FORNECEDOR,COUNT(*) 
FROM PRODUTOS_FORNECEDORES 
GROUP BY FORNECEDOR;

#USANDO JOIN PARA SABER POR NOME DE CADA FORNECEDOR
SELECT F.NOME, COUNT(PF.PRODUTO) QUANTIDADE
FROM PRODUTOS_FORNECEDORES PF
JOIN FORNECEDORES F ON F.ID_FORNECEDOR = PF.FORNECEDOR
GROUP BY F.NOME;

#3 - QUAL É O NÚMERO TOTAL DE PRODUTOS EM ESTOQUE?
#EM TODOS OS ARMAZENS SOMADOS
SELECT ARMAZEM, SUM(QUANTIDADE) AS TOTAL_ESTOQUE 
FROM PRODUTOS_ARMAZENS
GROUP BY ARMAZEM;

#POR ARMAZEM USANDO JOIN
SELECT A.ID_ARMAZEM, A.NOME_ARMAZEM, SUM(PA.QUANTIDADE) AS QTDE_ARMAZEM 
FROM PRODUTOS_ARMAZENS PA
JOIN ARMAZENS A ON A.ID_ARMAZEM = PA.ARMAZEM
GROUP BY A.ID_ARMAZEM
ORDER BY A.ID_ARMAZEM;

#BDEX5
USE BDEX5_EVENTOS;

#1 - QUAIS SÃO OS NOMES E DATAS DOS EVENTOS CADASTRADOS?
SELECT NOME_EVENTO,DATA_EVENTO
FROM EVENTOS;

#2 - QUANTAS ATIVIDADES ESTÃO PLANEJADAS PARA CADA EVENTO?
SELECT E.NOME_EVENTO EVENTO,COUNT(A.EVENTO_ATV) ATIVIDADES
FROM ATIVIDADES A 
JOIN EVENTOS E ON A.EVENTO_ATV = E.ID_EVENTO
GROUP BY EVENTO_ATV;

#3 - QUAL É O NÚMERO MÉDIO DE PARTICIPANTES POR EVENTO?
SELECT EVENTO,COUNT(*) 
FROM PARTICIPANTE_EVENTO 
GROUP BY EVENTO;

#BDEX6
USE BDEX6_CINEMA;
#1 - QUAIS SÃO OS NOMES E CAPACIDADES DE TODAS AS SALAS DE CINEMA CADASTRADAS?
SELECT NOME,CAPACIDADE 
FROM SALAS;

#2 - QUANTOS ESPECTADORES FREQUENTARAM CADA SESSÃO DE CINEMA?
SELECT SESSAO,COUNT(ESPECTADOR) 
FROM INGRESSOS 
GROUP BY SESSAO;

#3 - QUAL É O HORÁRIO MÉDIO DE INÍCIO DAS SESSÕES DE CINEMA?
SELECT TIME_FORMAT(AVG(HOUR(HORA_ING)), '%H:%I:%S') AS HORARIO_MEDIO_INICIO
FROM INGRESSOS;

#BDEX7
USE BDEX7_TRANSACOESBANCARIAS;
#1 - QUAIS SÃO OS NOMES E CPFS DE TODOS OS USUÁRIOS CADASTRADOS?
SELECT NOME_USER, CPF_USER 
FROM USUARIOS;

#2 - QUAL É O TOTAL DE TRANSAÇÕES REALIZADAS POR CADA USUÁRIO?
SELECT USUARIO, COUNT(*) FROM TRANSACOES
GROUP BY USUARIO;

#USANDO JOIN
SELECT U.NOME_USER USUARIO, COUNT(*) NO_TRANSACOES FROM TRANSACOES T
JOIN USUARIOS U ON T.USUARIO = U.ID_USER
GROUP BY U.NOME_USER;

#3 - QUAL É O VALOR MÉDIO DAS TRANSAÇÕES BANCÁRIAS?
SELECT ROUND(AVG(VALOR),2) VALOR_MEDIO 
FROM TRANSACOES;
